<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>Coconut AI Food Miniapp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --tq: #13e8c8;
      --tq-soft: #39c5b8;
      --bg1: #050816;
      --bg2: #031018;
      --glass: rgba(255,255,255,0.12);
      --glass-border: rgba(255,255,255,0.32);
      --text: #ffffff;
      --text-muted: #cdd3df;
    }

    body {
      margin: 0;
      font-family: system-ui, sans-serif;
      background: linear-gradient(135deg, var(--bg1), var(--bg2));
      color: var(--text);
      padding: 16px;
    }

    /* -----------------------------------
       WELCOME BLOCK + ANIMATION
    ----------------------------------- */
    @keyframes fadeSlideUp {
      0% { opacity: 0; transform: translateY(20px); }
      60% { opacity: 1; transform: translateY(0); }
      100% { opacity: 1; transform: none; }
    }

    @keyframes popIn {
      0% { transform: scale(0.85); opacity: 0; }
      70% { transform: scale(1.03); opacity: 1; }
      100% { transform: scale(1); }
    }

    .welcome-simple {
      animation: fadeSlideUp 0.8s ease-out forwards;
      background: var(--glass);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 18px;
      text-align: center;
      margin-bottom: 20px;
    }

    .welcome-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--tq);
    }

    .welcome-text {
      margin-top: 8px;
      font-size: 15px;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .welcome-btn {
      margin-top: 15px;
      animation: popIn 0.6s ease-out 0.8s both;
      background: var(--tq);
      border: none;
      border-radius: 14px;
      padding: 14px;
      width: 100%;
      font-size: 16px;
      color: #000;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 0 16px rgba(19,232,200,0.3);
    }

    /* -----------------------------------
       BLOCK STYLES
    ----------------------------------- */
    .card {
      background: var(--glass);
      border-radius: 18px;
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(12px);
      padding: 16px;
      margin-bottom: 18px;
    }

    .card-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 6px;
      color: var(--tq);
    }

    .card-sub {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    textarea, input[type="text"], input[type="file"] {
      width: 100%;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.2);
      color: var(--text);
      padding: 12px;
      border-radius: 12px;
      font-size: 14px;
      margin-bottom: 10px;
    }

    .btn {
      width: 100%;
      background: var(--tq);
      border: none;
      border-radius: 12px;
      padding: 12px;
      font-size: 15px;
      font-weight: 700;
      color: black;
      cursor: pointer;
    }

    .output {
      margin-top: 10px;
      padding: 12px;
      border-radius: 12px;
      background: rgba(255,255,255,0.06);
      border: 1px dashed rgba(255,255,255,0.2);
      font-size: 13px;
      min-height: 40px;
      white-space: pre-wrap;
    }
  </style>
</head>

<body>

  <!-- WELCOME BLOCK -->
  <div class="welcome-simple">
    <div class="welcome-title">–ü—Ä–∏–≤—ñ—Ç! üëã</div>
    <div class="welcome-text">
      –¢—É—Ç —Ç–∏ –æ—Ç—Ä–∏–º–∞—î—à –±–∞–≥–∞—Ç–æ –∫–æ—Ä–∏—Å–Ω–æ–≥–æ –¥–ª—è —Å–µ–±–µ.<br>
      –©–æ–± –ø–æ—á–∞—Ç–∏ ‚Äî –Ω–∞—Ç–∏—Å–Ω–∏ –∫–Ω–æ–ø–∫—É <b>Coconut AI</b> –Ω–∏–∂—á–µ.
    </div>

    <button class="welcome-btn" onclick="scrollToActions()">
      üå¥ –í—ñ–¥–∫—Ä–∏—Ç–∏ Coconut AI
    </button>
  </div>

  <!-- CHAT -->
  <div id="actions">
    <div class="card">
      <div class="card-title">üß† AI-—á–∞—Ç</div>
      <div class="card-sub">–ü–∏—Ç–∞–π —â–æ —Ö–æ—á–µ—à ‚Äî —Ä–µ—Ü–µ–ø—Ç–∏, –ø–æ—Ä–∞–¥–∏, –∫–∞–ª–æ—Ä—ñ—ó, –∑–∞–º—ñ–Ω–∏.</div>

      <textarea id="chat-input" placeholder="–ù–∞–ø–∏—à–∏ —Å–≤–æ—î –ø–∏—Ç–∞–Ω–Ω—è..."></textarea>
      <button class="btn" id="chat-send">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>

      <div id="chat-output" class="output" style="display:none;"></div>
    </div>

    <!-- SEARCH -->
    <div class="card">
      <div class="card-title">üîé –ü–æ—à—É–∫ —Ä–µ—Ü–µ–ø—Ç—É</div>
      <input id="search-input" type="text" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ø–∞—Å—Ç–∞ –∑ –∫—É—Ä–∫–æ—é">
      <button class="btn" id="search-run">–ó–Ω–∞–π—Ç–∏ —Ä–µ—Ü–µ–ø—Ç</button>
      <div id="search-results" class="output"></div>
    </div>

    <!-- VISION -->
    <div class="card">
      <div class="card-title">üì∏ –ê–Ω–∞–ª—ñ–∑ —Ñ–æ—Ç–æ –ø—Ä–æ–¥—É–∫—Ç—É</div>
      <input id="vision-file" type="file" accept="image/*">
      <button class="btn" id="vision-run">–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏</button>
      <div id="vision-output" class="output"></div>
    </div>

    <!-- PRODUCT FINDER -->
    <div class="card">
      <div class="card-title">üõí –ü—ñ–¥—ñ–±—Ä–∞—Ç–∏ —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏</div>
      <input id="product-input" type="text" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –±–µ–∑–ª–∞–∫—Ç–æ–∑–Ω–µ –º–æ–ª–æ–∫–æ">
      <button class="btn" id="product-run">–ó–Ω–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä</button>
      <div id="product-output" class="output"></div>
    </div>
  </div>

<script>
function scrollToActions() {
  document.getElementById("actions").scrollIntoView({ behavior: "smooth" });
}

async function api(path, body, isFormData = false) {
  const opts = {
    method: "POST",
    headers: isFormData ? {} : { "Content-Type": "application/json" },
    body: isFormData ? body : JSON.stringify(body)
  };
  const res = await fetch(path, opts);
  return res.json();
}

// CHAT
document.getElementById("chat-send").onclick = async () => {
  const text = chat-input.value.trim();
  if (!text) return;
  chat-output.style.display = "block";
  chat-output.innerText = "–î—É–º–∞—é‚Ä¶";
  const r = await api("/api/chat", { message: text });
  chat-output.innerText = r.answer || "–ü–æ–º–∏–ª–∫–∞";
};

// SEARCH
document.getElementById("search-run").onclick = async () => {
  const q = search-input.value.trim();
  if (!q) return;
  const r = await api("/api/search", { query: q });
  search-results.innerText = JSON.stringify(r, null, 2);
};

// VISION
document.getElementById("vision-run").onclick = async () => {
  const f = vision-file.files[0];
  if (!f) return;
  const fd = new FormData();
  fd.append("image", f);
  const r = await api("/api/analyze-image", fd, true);
  vision-output.innerText = r.result || "–ü–æ–º–∏–ª–∫–∞";
};

// PRODUCTS
document.getElementById("product-run").onclick = async () => {
  const txt = product-input.value.trim();
  const r = await api("/api/find-product", { ingredient: txt });
  product-output.innerText = r.link || "–ü–æ–º–∏–ª–∫–∞";
};
</script>

</body>
</html>
